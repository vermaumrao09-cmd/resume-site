<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Insta Reel Downloader - Pro Bypass</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --insta-gradient: linear-gradient(45deg, #f09433 0%, #e6683c 25%, #dc2743 50%, #cc2366 75%, #bc1888 100%);
            --bg: #09090b; --card: #18181b; --border: #27272a; --text: #f8fafc;
        }
        body { font-family: 'Inter', sans-serif; background: var(--bg); color: var(--text); display: flex; justify-content: center; align-items: center; min-height: 100vh; margin: 0; padding: 20px; }
        .container { background: var(--card); padding: 2.5rem; border-radius: 24px; border: 1px solid var(--border); width: 100%; max-width: 420px; text-align: center; box-shadow: 0 20px 50px rgba(0,0,0,0.5); }
        h1 { margin-bottom: 25px; font-weight: 800; background: var(--insta-gradient); -webkit-background-clip: text; -webkit-text-fill-color: transparent; font-size: 2rem; }
        .input-group { margin-bottom: 20px; }
        input { width: 100%; padding: 15px; border-radius: 12px; border: 1px solid var(--border); background: #000; color: #fff; box-sizing: border-box; outline: none; transition: 0.3s; font-size: 1rem; }
        input:focus { border-color: #d62976; box-shadow: 0 0 0 2px rgba(214, 41, 118, 0.2); }
        button { width: 100%; padding: 15px; border-radius: 12px; border: none; background: var(--insta-gradient); color: white; font-weight: 700; cursor: pointer; font-size: 1.1rem; transition: transform 0.2s; }
        button:active { transform: scale(0.98); }
        #status { margin-top: 20px; font-size: 0.9rem; color: #94a3b8; line-height: 1.5; }
        
        /* Video Result Area */
        #resultArea { display: none; flex-direction: column; align-items: center; margin-top: 30px; animation: fadeIn 0.5s ease; }
        video { width: 100%; border-radius: 16px; border: 1px solid var(--border); background: #000; margin-bottom: 20px; }
        .dl-btn { width: 100%; padding: 14px; background: #22c55e; color: white; text-decoration: none; border-radius: 12px; font-weight: 700; display: block; margin-bottom: 10px; }
        .reset-btn { background: transparent; color: #94a3b8; border: 1px solid var(--border); padding: 10px 20px; border-radius: 10px; cursor: pointer; }
        
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>

<div class="container">
    <div id="searchBox">
        <h1>Reel Saver</h1>
        <div class="input-group">
            <input type="text" id="reelUrl" placeholder="Instagram Link Paste Karein...">
        </div>
        <button onclick="processDownload()" id="mainBtn">Video Link Nikalein</button>
    </div>

    <div id="status"></div>

    <div id="resultArea">
        <video id="videoPlayer" controls playsinline>
            Your browser does not support the video tag.
        </video>
        <a id="downloadLink" href="#" target="_blank" class="dl-btn">✔ DOWNLOAD VIDEO (.MP4)</a>
        <button class="reset-btn" onclick="resetUI()">Download Another</button>
    </div>
</div>

<script>
    async function processDownload() {
        const urlInput = document.getElementById('reelUrl').value.trim();
        const status = document.getElementById('status');
        const searchBox = document.getElementById('searchBox');
        const resultArea = document.getElementById('resultArea');
        const videoPlayer = document.getElementById('videoPlayer');
        const downloadLink = document.getElementById('downloadLink');
        const btn = document.getElementById('mainBtn');

        // Aapki Worker ID jisme spoofing code hai
        const workerUrl = "https://dry-bar-ef61.vermaumrao09.workers.dev/";

        if (!urlInput) return alert("Pehle Instagram link paste karein!");

        // Loading state
        status.innerHTML = "Security bypass successful! Video nikal rahe hain...";
        btn.disabled = true;
        btn.style.opacity = "0.7";

        try {
            const response = await fetch(workerUrl, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ reelUrl: urlInput })
            });

            const data = await response.json();

            // JSON response check
            if (data.status === "success" && data.url) {
                status.innerHTML = "<span style='color: #22c55e;'>✔ Video Mil Gayi!</span>";
                
                // 1. UI update
                searchBox.style.display = "none";
                resultArea.style.display = "flex";
                
                // 2. Video aur Download link set karein
                // Note: Agar 'url' play na ho to 'proxy_url' bhi try kar sakte hain
                videoPlayer.src = data.url; 
                downloadLink.href = data.url;
                
                videoPlayer.load();
            } else {
                status.innerHTML = `<span style="color: #ef4444;">Error: ${data.error || "Video link nahi mil saka."}</span>`;
                btn.disabled = false;
                btn.style.opacity = "1";
            }
        } catch (error) {
            console.error(error);
            status.innerHTML = "<span style='color: #ef4444;'>Connection Error. Worker deploy hua hai ya nahi check karein.</span>";
            btn.disabled = false;
            btn.style.opacity = "1";
        }
    }

    function resetUI() {
        document.getElementById('searchBox').style.display = "block";
        document.getElementById('resultArea').style.display = "none";
        document.getElementById('status').innerHTML = "";
        document.getElementById('reelUrl').value = "";
        document.getElementById('mainBtn').disabled = false;
        document.getElementById('mainBtn').style.opacity = "1";
        document.getElementById('videoPlayer').pause();
        document.getElementById('videoPlayer').src = "";
    }
</script>

</body>
</html>
